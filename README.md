# `create_and_pay_order` — Скрипт для создания и оплаты заказов

## Описание

Этот скрипт позволяет создать и оплатить несколько заказов через API сервиса AzaliaNow. Он выполняет следующие операции:

1. **Отправка кода подтверждения на телефон**.
2. **Аутентификация с использованием кода подтверждения**.
3. **Создание доставки** (если не указана самовывоз).
4. **Создание заказа с указанием товаров, местоположения и получателя**.
5. **Оплата заказов через Тинькофф**.

Каждый заказ проходит через все эти этапы, и в конце отправляется запрос на подтверждение оплаты.

## Как использовать

### 1. Установка виртуального окружения

Для изоляции зависимостей рекомендуется создать виртуальное окружение. Это позволяет избежать конфликтов между версиями библиотек в разных проектах.

1. **Установите Python 3**, если он ещё не установлен. Вы можете проверить версию Python командой:

   ```bash
   python --version
   ```
Создайте виртуальное окружение. Выполните команду в директории проекта:
Windows:
   ```bash
python -m venv venv
```
Mac/Linux:
   ```bash
python3 -m venv venv
```
Активируйте виртуальное окружение:
Windows:
   ```bash
.\venv\Scripts\activate
```
Mac/Linux:
   ```bash
source venv/bin/activate
```
После активации виртуального окружения ваш терминал должен показать имя окружения, например, (venv) в начале строки.
Установите зависимости:
Установите необходимые библиотеки, используя pip:
   ```bash
pip install -r requirements.txt
```
Если у вас нет файла requirements.txt, вы можете установить нужные библиотеки вручную. В данном случае, достаточно установить библиотеку requests:
   ```bash
pip install requests
```
### 2.  Пример использования
create_and_pay_order(
    ENV='preprod',        # Окружение: preprod, staging, test1
    num_orders=645,       # Количество заказов, которое нужно создать и оплатить
    delivery_type="self", # Тип доставки: internal, external, self (самовывоз)
    request_source="web", # Источник запроса: web, mobile
    delivery_day="2025-02-01"  # Дата доставки в формате 'YYYY-MM-DD'
)
## Параметры функции
ENV (str): Окружение для API. Варианты: 'preprod', 'staging', 'test1'.
num_orders (int): Количество заказов, которые необходимо создать и оплатить.
delivery_type (str): Тип доставки:
'internal': Внутренний (не самовывоз).
'external': Внешний (не самовывоз).
'self': Самовывоз.
request_source (str): Источник запроса:
'web': Веб-приложение.
'mobile': Мобильное приложение.
delivery_day (str): Дата доставки в формате 'YYYY-MM-DD'. Если не указано, будет использоваться завтрашняя дата.
## Как работает функция
Генерация даты доставки: Если дата не передана, функция будет использовать завтрашнюю дату.
Отправка кода подтверждения: Скрипт отправляет запрос на API для отправки кода на номер телефона.
Аутентификация: Скрипт аутентифицирует пользователя с использованием полученного кода.
Создание доставки: Если выбран тип доставки, отличающийся от самовывоза, отправляется запрос на создание доставки.
Получение данных клиента: Скрипт получает информацию о клиенте через API.
Создание заказа: Создаётся заказ с выбранными товарами и доставкой.
Оплата заказа: Скрипт отправляет запрос на оплату заказа через систему Тинькофф.
## Логирование
Каждый шаг процесса (отправка кода, создание заказа, подтверждение оплаты) выводится в консоль для отслеживания прогресса.

Пример вывода:
Delivery_id: 12345
Customer Name: Иван Иванов
UID: abc123456
Status Code: 200
Response Body: {"status": "payment_success", "message": "Оплата успешна"}
Время создания и оплаты заказов в количестве: 645 составляет: 150.2345 секунд
## Важные замечания
Функция предназначена для тестирования и использования в разработке. Для массового использования необходимо добавить контроль за количеством одновременных запросов (например, с помощью многозадачности или асинхронности).
Убедитесь, что ваши API-ключи и параметры окружения корректны.
## Советы по улучшению
Для обработки большого количества заказов можно добавить многозадачность или использовать асинхронные запросы для увеличения скорости выполнения.
Использование обработки ошибок и повторных попыток для повышения надежности.